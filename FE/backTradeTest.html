<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Backtest Runner</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="container about">
    <h2>Backtrader â€” Strategy Runner</h2>

    <form id="btForm" class="row two-col">
      <label>Symbol
        <input name="symbol" placeholder="AAPL" required />
      </label>
      <label>Strategy
        <select name="strategy" id="strategy" required></select>
      </label>
      <button type="submit" style="grid-column:1/-1">Run Backtest</button>
      <small id="status" class="muted" style="grid-column:1/-1"></small>
    </form>

    <div id="out" class="article" style="display:none">
      <h3>KPIs</h3>
      <ul id="metrics" class="metrics"></ul>
      <div id="plots" class="grid" style="gap:12px"></div>
    </div>
  </main>

  <script>
    const API = "https://fintech-portfolio-546985714630.europe-west1.run.app";

    // 1) Load strategies
    (async () => {
      const sel = document.getElementById('strategy');
      try {
        const r = await fetch(`${API}/api/strategies`);
        const data = await r.json(); // backend returns { items: [...] }
        const items = data.items || data;
        sel.innerHTML = items.map(s => `<option value="${s}">${s}</option>`).join('');
      } catch {
        sel.innerHTML = `<option value="SmaCross">SmaCross</option>`;
      }
    })();

    
  </script>
</body>
</html>
